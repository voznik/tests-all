"use strict";(self.webpackChunkghv=self.webpackChunkghv||[]).push([[728],{3728:(V,C,a)=>{a.r(C),a.d(C,{IssuesModule:()=>W});var e=a(5678),v=a(4899),F=a(9373),u=a(5605),D=a(5619),A=a(9384),y=a(7921),T=a(9360),I=a(8251),O=a(4829),U=a(2737),w=a(2420),L=a(9940),N=a(4664),$=a(7398);const b=s=>{if(!s)return{issues:[],totalCount:0,pageInfo:{hasNextPage:!1,hasPreviousPage:!1}};const c=s.pageInfo,o=s.totalCount;return{issues:s.nodes.reduce((r,i)=>{const p=i.labels.nodes.reduce((d,h)=>h?[...d,{color:h.color,name:h.name}]:d,[]);return[...r,{id:i.id,url:i.url,login:i.author?.login,commentCount:i.comments.totalCount,labelCount:i.labels.totalCount,labels:p,closed:i.closed,title:i.title,number:i.number,createdAt:new Date(i.createdAt),closedAt:i.closedAt?new Date(i.closedAt):void 0}]},[]),totalCount:o,pageInfo:c}};var Z=a(2014),m=a(6814),l=a(460);function _(s,c){if(1&s&&(e.TgZ(0,"span",7)(1,"span",8),e._uU(2),e.qZA()()),2&s){const t=c.$implicit,o=e.oxw(2);e.xp6(1),e.Udp("background-color",o.colorMap(t.color)),e.xp6(1),e.hij(" ",t.name," ")}}function z(s,c){if(1&s&&(e.TgZ(0,"clr-dg-row")(1,"clr-dg-cell"),e._uU(2),e.qZA(),e.TgZ(3,"clr-dg-cell")(4,"a",5),e._uU(5),e.qZA(),e._uU(6," \xa0 "),e.YNc(7,_,3,3,"span",6),e.qZA(),e.TgZ(8,"clr-dg-cell"),e._uU(9),e.ALo(10,"date"),e.qZA(),e.TgZ(11,"clr-dg-cell"),e._uU(12),e.qZA()()),2&s){const t=c.$implicit;e.xp6(2),e.Oqu(null==t?null:t.number),e.xp6(2),e.Q6J("href",t.url,e.LSH),e.xp6(1),e.hij(" ",null==t?null:t.title,""),e.xp6(2),e.Q6J("ngForOf",t.labels),e.xp6(2),e.Oqu(e.lcZ(10,6,null==t?null:t.createdAt)),e.xp6(3),e.hij(" ",null==t?null:t.commentCount,"")}}const j=()=>[20,50,100];let x=(()=>{class s{constructor(t,o){this.logger=t,this.dialogService=o,this.issues=[],this.loading=!1,this.login="",this.page=1,this.total=0,this.pageSize=20,this.pageChange=new e.vpe,this.paginationStateChange=new e.vpe,this.baseDate=new Date}getColor(t){return{"background-color":`#${t}`}}colorMap(t){switch(t){case"D4C5F9":return"#ddd6fe";case"310D85":return"#c084fc";case"6ED842":return"#bef264";case"ED1DB5":return"#f9a8d4";default:return`#${t}`}}getBadgeClass(t){switch(t){case"D4C5F9":return"badge-light-purple";case"310D85":return"badge-purple";case"6ED842":return"badge-success";case"ED1DB5":return"badge-pink";default:return"badge-warning"}}gridRefresh(t){this.logger.log("gridRefresh",t),this.paginationStateChange.emit(t)}static#e=this.\u0275fac=function(o){return new(o||s)(e.Y36(v.Yd),e.Y36(Z.KU))};static#t=this.\u0275cmp=e.Xpm({type:s,selectors:[["ghv-issues-list"]],inputs:{issues:"issues",loading:"loading",login:"login",page:"page",total:"total",pageSize:"pageSize"},outputs:{pageChange:"pageChange",paginationStateChange:"paginationStateChange"},decls:18,vars:9,consts:[[2,"height","640px",3,"clrDgLoading","clrDgRefresh"],[4,"ngFor","ngForOf"],[3,"clrDgTotalItems","clrDgPageSize"],["pagination",""],[3,"clrPageSizeOptions"],["target","_blank",3,"href"],["class","inline",4,"ngFor","ngForOf"],[1,"inline"],[1,"badge"]],template:function(o,n){if(1&o&&(e.TgZ(0,"clr-datagrid",0),e.NdJ("clrDgRefresh",function(i){return n.gridRefresh(i)}),e.TgZ(1,"clr-dg-detail-header"),e._uU(2,"Top Repositories"),e.qZA(),e.TgZ(3,"clr-dg-column"),e._uU(4,"Issue #"),e.qZA(),e.TgZ(5,"clr-dg-column"),e._uU(6,"Title"),e.qZA(),e.TgZ(7,"clr-dg-column"),e._uU(8,"Creation date"),e.qZA(),e.TgZ(9,"clr-dg-column"),e._uU(10,"Comment count"),e.qZA(),e.YNc(11,z,13,8,"clr-dg-row",1),e.TgZ(12,"clr-dg-footer")(13,"clr-dg-pagination",2,3)(15,"clr-dg-page-size",4),e._uU(16,"Repos per page"),e.qZA(),e._uU(17),e.qZA()()()),2&o){const r=e.MAs(14);e.Q6J("clrDgLoading",n.loading),e.xp6(11),e.Q6J("ngForOf",n.issues),e.xp6(2),e.Q6J("clrDgTotalItems",n.total)("clrDgPageSize",n.pageSize),e.xp6(2),e.Q6J("clrPageSizeOptions",e.DdM(8,j)),e.xp6(2),e.lnq(" ",r.firstItem+1," - ",r.lastItem+1," of ",r.totalItems," users ")}},dependencies:[m.sg,l.C9t,l.fv_,l.m4W,l.ygj,l.dRQ,l.YYR,l.Ltv,l.Z4N,l.jND,l.KHL,l.PDs,l.Gcc,l.dml,l.Nh1,l.K8c,m.uU]})}return s})();function R(s,c){if(1&s&&(e.ynx(0),e.TgZ(1,"div",5),e._uU(2),e.qZA(),e.BQk()),2&s){const t=c.$implicit;e.xp6(2),e.Oqu(t.label)}}function B(s,c){if(1&s&&(e.TgZ(0,"clr-dropdown-menu",3),e.YNc(1,R,3,1,"ng-container",4),e.qZA()),2&s){const t=e.oxw();e.xp6(1),e.Q6J("ngForOf",t.items)}}let S=(()=>{class s{constructor(t){this.elRef=t,this.name="",this.description="",this.current="",this.items=[],this.toggle=!1,this.setFilter=new e.vpe,this.isOpen=!1}toggleMenu(){this.isOpen=!this.isOpen}handleSetFilterClick(t){this.setFilter.emit(t===this.current?this.toggle?"":this.items[0].value:t),this.isOpen=!1}handleClearFilterClick(){this.setFilter.emit(this.items[0].value),this.isOpen=!1}static#e=this.\u0275fac=function(o){return new(o||s)(e.Y36(e.SBq))};static#t=this.\u0275cmp=e.Xpm({type:s,selectors:[["ghv-filter-dropdown"]],inputs:{name:"name",description:"description",current:"current",items:"items",toggle:"toggle"},outputs:{setFilter:"setFilter"},standalone:!0,features:[e.jDz],decls:5,vars:1,consts:[["clrDropdownTrigger","",1,"btn","btn-outline"],["shape","angle","direction","down"],["clrPosition","bottom-right",4,"clrIfOpen"],["clrPosition","bottom-right"],[4,"ngFor","ngForOf"],["clrDropdownItem",""]],template:function(o,n){1&o&&(e.TgZ(0,"clr-dropdown")(1,"button",0),e._uU(2),e._UZ(3,"cds-icon",1),e.qZA(),e.YNc(4,B,2,1,"clr-dropdown-menu",2),e.qZA()),2&o&&(e.xp6(2),e.hij(" ",n.name," "))},dependencies:[m.ez,m.sg,l.VZT,l.f_W,l.zwp,l.ZUS,l.lU3,l.nqY,l.nkF,l.eu2]})}return s})();const E=[{label:"Newest",value:`${u.UDC.CreatedAt}^${u.N9t.Desc}`},{label:"Oldest",value:`${u.UDC.CreatedAt}^${u.N9t.Asc}`},{label:"Most commented",value:`${u.UDC.Comments}^${u.N9t.Desc}`},{label:"Least commented",value:`${u.UDC.Comments}^${u.N9t.Asc}`},{label:"Recently updated",value:`${u.UDC.UpdatedAt}^${u.N9t.Desc}`},{label:"Least recently updated",value:`${u.UDC.UpdatedAt}^${u.N9t.Asc}`}];let Y=(()=>{class s{constructor(){this.openCount=0,this.closedCount=0,this.currentMilestone=null,this.currentLabel="",this.sort=null,this.issueState=u.scQ.Open,this.openIssue=new e.vpe,this.closeIssue=new e.vpe,this.setLabel=new e.vpe,this.setMilestone=new e.vpe,this.setSort=new e.vpe,this.labelOptions=[],this.milestoneOptions=[],this.sortOptions=E}set milestones(t){const n=[{title:"Issue with no milestone",id:""},...t];this.milestoneOptions=n.map(r=>({label:r.title,value:r.id}))}set labels(t){this.labelOptions=t.map(n=>({label:n.name,value:n.name}))}getOpenStyle(){return this.issueState===u.scQ.Open?"font-semibold text-gray-900":"text-gray-600"}getClosedStyle(){return this.issueState===u.scQ.Closed?"font-semibold text-gray-900":"text-gray-600"}handleOpenIssueClick(){this.openIssue.emit()}handleCloseIssueClick(){this.closeIssue.emit()}handleLabelClick(t){this.setLabel.emit(t)}handleMilestoneClick(t){this.setMilestone.emit(t)}handleSortClick(t){this.setSort.emit(t)}static#e=this.\u0275fac=function(o){return new(o||s)};static#t=this.\u0275cmp=e.Xpm({type:s,selectors:[["ghv-issues-filters"]],inputs:{openCount:"openCount",closedCount:"closedCount",currentMilestone:"currentMilestone",milestones:"milestones",currentLabel:"currentLabel",labels:"labels",sort:"sort",issueState:"issueState"},outputs:{openIssue:"openIssue",closeIssue:"closeIssue",setLabel:"setLabel",setMilestone:"setMilestone",setSort:"setSort"},decls:12,vars:11,consts:[[1,"filters-container"],[1,"btn-group"],["data-testid","openIssuesButton",1,"btn",3,"ngClass","click"],["name","minus-circle","type","outline","aria-hidden","true",1,"typeIcon"],["data-testid","closedIssuesButton",1,"btn",3,"ngClass","click"],["name","check","type","outline","aria-hidden","true",1,"typeIcon"],["name","Label","description","Filter by label",1,"_btn",3,"current","items","toggle","setFilter"],["name","Milestones","description","Filter by milestone",1,"_btn",3,"current","items","setFilter"],["name","Sort","description","Sort by",1,"_btn",3,"current","items","setFilter"]],template:function(o,n){1&o&&(e.TgZ(0,"div",0)(1,"div",1)(2,"button",2),e.NdJ("click",function(){return n.handleOpenIssueClick()}),e._UZ(3,"cds-icon",3),e._uU(4),e.qZA(),e.TgZ(5,"button",4),e.NdJ("click",function(){return n.handleCloseIssueClick()}),e._UZ(6,"cds-icon",5),e._uU(7),e.qZA()(),e.TgZ(8,"div",1)(9,"ghv-filter-dropdown",6),e.NdJ("setFilter",function(i){return n.handleLabelClick(i)}),e.qZA(),e.TgZ(10,"ghv-filter-dropdown",7),e.NdJ("setFilter",function(i){return n.handleMilestoneClick(i)}),e.qZA(),e.TgZ(11,"ghv-filter-dropdown",8),e.NdJ("setFilter",function(i){return n.handleSortClick(i)}),e.qZA()()()),2&o&&(e.xp6(2),e.Q6J("ngClass",n.getOpenStyle()),e.xp6(2),e.hij(" ",n.openCount," Open "),e.xp6(1),e.Q6J("ngClass",n.getClosedStyle()),e.xp6(2),e.hij(" ",n.closedCount," Closed "),e.xp6(2),e.Q6J("current",n.currentLabel)("items",n.labelOptions)("toggle",!0),e.xp6(1),e.Q6J("current",n.currentMilestone)("items",n.milestoneOptions),e.xp6(1),e.Q6J("current",(null==n.sort?null:n.sort.field)+"^"+(null==n.sort?null:n.sort.direction))("items",n.sortOptions))},dependencies:[m.mk,l.nkF,S],styles:[".filters-container[_ngcontent-%COMP%]{display:flex;padding-top:1rem;justify-content:space-between}"],changeDetection:0})}return s})();var k=a(8091);let q=(()=>{class s{constructor(){this.routeConfigService=(0,e.f3M)(v.o5),this.repoIssuesGQL=(0,e.f3M)(u.b2U),this.paginationState$=new D.X({page:{current:1,from:0,to:19,size:20}}),this.pageSize=20,this.total=0,this.openIssuesCount=0,this.closedIssuesCount=0,this.loading=!0,this.query$=this.paginationState$.pipe((0,A.G)(),(0,y.O)([{},this.paginationState$.value]),function M(...s){const c=(0,L.jO)(s);return(0,T.e)((t,o)=>{const n=s.length,r=new Array(n);let i=s.map(()=>!1),g=!1;for(let p=0;p<n;p++)(0,O.Xf)(s[p]).subscribe((0,I.x)(o,d=>{r[p]=d,!g&&!i[p]&&(i[p]=!0,(g=i.every(U.y))&&(i=null))},w.Z));t.subscribe((0,I.x)(o,p=>{if(g){const d=[p,...r];o.next(c?c(...d):d)}}))})}(this.routeConfigService.getLeafConfig("repoPageData")),(0,N.w)(([[t,o],{owner:n,name:r}])=>{this.loading=!0;const i={...(0,u.MZs)(t,o,this.startCursor,this.endCursor,!1),owner:n,name:r,orderBy:{field:u.UDC.CreatedAt,direction:u.N9t.Desc}};return this.repoIssuesGQL.watch(i).valueChanges}),(0,$.U)(({data:t,loading:o})=>{this.loading=o;const{openIssues:n,closedIssues:r}=(s=>{const c=b(s?.repository?.openIssues),t=b(s?.repository?.closedIssues),o=(s=>s.nodes.reduce((t,o)=>o?[...t,{id:o.id,closed:o.closed,title:o.title,number:o.number,description:o.description}]:t,[]))(s.repository?.milestones),n=[...t.issues,...c.issues].reduce((r,i)=>{const g={};return i.labels.forEach(p=>{g[p.name]=p}),{...r,...g}},{});return{openIssues:c,closedIssues:t,milestones:o,labels:Object.values(n)}})(t),{issues:p,pageInfo:d,totalCount:h}=n,{totalCount:K}=r;return this.openIssuesCount=h,this.closedIssuesCount=K,this.total=h,this.startCursor=d.startCursor,this.endCursor=d.endCursor,p}))}paginationStateChange(t){t.page.from<0||(0,F.ht)(t,this.paginationState$.value)||this.paginationState$.next(t)}static#e=this.\u0275fac=function(o){return new(o||s)};static#t=this.\u0275cmp=e.Xpm({type:s,selectors:[["ghv-issues"]],decls:3,vars:8,consts:[[3,"openCount","closedCount"],[3,"loading","total","pageSize","issues","paginationStateChange"]],template:function(o,n){1&o&&(e._UZ(0,"ghv-issues-filters",0),e.TgZ(1,"ghv-issues-list",1),e.NdJ("paginationStateChange",function(i){return n.paginationStateChange(i)}),e.ALo(2,"ngrxPush"),e.qZA()),2&o&&(e.Q6J("openCount",n.openIssuesCount)("closedCount",n.closedIssuesCount),e.xp6(1),e.Q6J("loading",n.loading)("total",n.total)("pageSize",n.pageSize)("issues",e.lcZ(2,6,n.query$)))},dependencies:[x,Y,k.fM],changeDetection:0})}return s})();var G=a(9987);const X=[{path:"",component:q}];let W=(()=>{class s{static#e=this.\u0275fac=function(o){return new(o||s)};static#t=this.\u0275mod=e.oAB({type:s});static#s=this.\u0275inj=e.cJS({imports:[Z.W2,G.Bz.forChild(X),S]})}return s})()}}]);